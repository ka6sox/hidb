version: "3"
services:
  web:
    # Give your image a static name
    image: ka6sox/hidb:v1

    # Give your container a static name
    container_name: hidb

    build:
      # Explicitly show docker-cli where your Dockerfile lies
      context: ./

      # Explicitly state the name of your dockerfile
      dockerfile: Dockerfile

    # Env file
    env_file:
      - .env
      
    # Expose ports
    ports:
      - 5000:5000

    # Persist database and uploaded photos
    volumes:
      - hidb-instance:/hidb/instance
      - hidb-photos:/hidb/hidb/static/photos

    # restart at boot
    restart: unless-stopped

volumes:
  hidb-instance:
  hidb-photos: